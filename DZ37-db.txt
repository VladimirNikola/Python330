1.С помощью объединения вывести данные о каждом заказчике, для которого определен продавец.
SELECT *
FROM Klient k INNER JOIN Prodaves p
ON p.ID_Pr = k.ID_Pr

2.Вывести имя заказчика и данные о средней цене доставки для него. Если цена доставки больше средней по таблице написать - lot, меньше – few
SELECT k.Name_KL, AVG(z.Cena_Dostavki), 'few'
FROM Klient k, Zakaz z
WHERE k.ID_KL = z.ID_KL
GROUP by k.Name_KL
HAVING AVG(z.Cena_Dostavki) >
    (SELECT AVG(z.Cena_Dostavki)
    FROM ZAKAZ)	

UNION

SELECT k.Name_KL, AVG(z.Cena_Dostavki), 'lot'
FROM Klient k, Zakaz z
WHERE k.ID_KL = z.ID_KL
GROUP by k.Name_KL
HAVING AVG(z.Cena_Dostavki) <
    (SELECT AVG(z.Cena_Dostavki)
    FROM ZAKAZ)	

3.Соедините вместе все таблицы с помощью внешнего объединения.
SELECT *
FROM Zakaz z LEFT JOIN Klient k ON z.ID_KL = k.ID_KL LEFT JOIN Prodaves p
ON k.ID_Pr=p.ID_Pr


4.С помощью объединения вывести данные о скидках клиента для каждого продавца
SELECT p.Name_Pr AS [Имя продавца], k.Name_KL AS [Имя Клиента], k.Discoun AS [Скидка продавца]
FROM Klient k INNER JOIN Prodaves p
ON p.ID_Pr = k.ID_Pr

5.Напишите запрос, который выведет все города, в которых живут продавцы и заказчики.
SELECT p.City_Pr, p.Name_pr
FROM Prodaves p

UNION

SELECT k.City_KL, k.Name_KL
FROM Klient k

6.С помощью объединения вывести все данные о заказчиках и  заказах, даже если заказчик не сделал ни одного заказа за указанный период.
SELECT k.*, z.*
FROM Klient k INNER JOIN Zakaz z
ON k.ID_KL = z.ID_KL

7.Составьте запроса для вывода имен и кодов всех продавцов, в чьих городах есть покупатели, которых они не обслуживают. С помощью оператора в подзапросе.
SELECT p.Name_Pr, p.ID_Pr
FROM Prodaves p
WHERE EXISTS
    (SELECT k.ID_KL
    FROM Klient k
    WHERE p.City_Pr = k.city_kl AND p.ID_Pr <> k.ID_Pr)

8.Напишите запрос, который выведет все города и имена продавцов и заказчиков, которые живут в Лондоне.
SELECT Name_Pr AS [Имена продавцов и заказчиков], City_Pr AS [Город проживания]
FROM Prodaves
WHERE City_Pr='London'

UNION 

SELECT Name_KL, City_KL
FROM Klient
WHERE City_KL='London';
 





